<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Weather API</title>
</head>

<body>
    <h2>current weather</h2>

    <h3 class="time">현재 시간: </h3>
    <h3 class="ctemp">현재 온도: </h3>
    <h3 class="lowtemp">최저 온도: </h3>
    <h3 class="hightemp">최고 온도: </h3>
    <h3 class="icon"></h3>
    <!-- icon등은 여기 참고 https://openweathermap.org/current#list -->

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" 
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>

    <script>
        $.getJSON('https://api.openweathermap.org/data/2.5/weather?q=Seoul&appid=a71cf8f55278a20a0840a3e6fcba9384&units=metric', 
        function(result){
            $('.ctemp').append(result.main.temp);  // api는 getNSON함수 안에서만 쓸 수 있으니까 이 코드 함수 안으로 넣기
            $('.lowtemp').append(result.main.temp_min);  
            $('.hightemp').append(result.main.temp_max);
            // result.weather[0].icon
            var wiconUrl = '<img src = "https://openweathermap.org/img/wn/'+result.weather[0].icon+'.png" alt="'+result.weather[0].description+'">'
            $('.icon').append(wiconUrl);
            //시분초 가져오기
            var ct = result.dt;
            function convertTime(t){
                var ot = new Date(t * 1000); // jQuery new Date : 밀리초로 가져온걸 가지고 보기쉽게 추출해줌
                //Tue Feb 16 2021 22:38:22 GMT+0900 (대한민국 표준시) : 너무 기니까 일부 정보만 출력
                var y = ot.getFullYear();
                var mon = ot.getMonth() + 1; // getMonth()는 0부터 시작하므로 +1 해줌
                var dt = ot.getDate();
                var days = ["일", "월", "화", "수", "목", "금", "토"];
                var day = days[ot.getDay()]; // 요일 이름 가져오기
                var hr = ot.getHours();
                var min = ot.getMinutes();
                
                return y + '/' + mon + '/' + dt + ' (' + day + ') ' + hr + ':' + (min < 10 ? '0' + min : min);
            }

            var currentTime =  convertTime(ct);
            $('.time').append(currentTime);
            
        });

       

    </script>
</body>
</html>
